#user-profile
  
  %section#user-info
  
    #picture-and-more
      #picture
        - if @user.avatar.url.include?("missing")
          = link_to(image_tag(@user.avatar.url(:editorial)), settings_user_path(@user), :class => "avatar")
        - else
          = link_to(image_tag(@user.avatar.url(:editorial)), user_path(@user), :class => "avatar")
      #and-more
        - if @user.location.present?
          #location.hoverable
            .icon
            .show-on-hover= image_tag "http://maps.googleapis.com/maps/api/staticmap?center=#{@user.location}&zoom=6&size=300x300&maptype=roadmap&sensor=false&markers=color:blue%7C#{@user.latitude},#{@user.longitude}"
          #occupation.hoverable
            .icon
            .show-on-hover.big-text= @user.occupation
            
      - if current_user && current_user.is_subscribed_to?(@user)
        = link_to "Unfollow", "#", :id => "subscribe"
      - elsif current_user && !me?(@user)
        = link_to "Follow", user_messages_path(@user), :id => "subscribe", :class => "tooltipped-n", :title => "Receive updates when #{@user.first_name} posts content and discussions."
      - elsif current_user.nil?
        = link_to "Follow", "#join-modal", :id => "subscribe", :class => "tooltipped-n", :title => "Receive updates when #{@user.first_name} posts content and discussions."
    
    %h1#name
      %span= @user.first_name
      %span= @user.last_name
    
    #bio= @user.tagline
  
  - if @user.is_a?(Creator)
    %section#my-work
      %h1 My Work
    
      #work-browser
        %ul.list
          - first = true
          - @content.each do |content|
            %li
              %a{:href => "#", :data => content.id, :class => first ? "selected" : "" }
                - if content.text_preview?
                  .content-preview.tiny{:class => "#{content.media_type} #{content.template}"}
                    .inner
                      .image
                      .quote= truncate(content.template_text, :length => 140)
                - else
                  .content-preview.tiny{:class => content.media_type}
                    .inner{:style => "background-image: url(#{content.thumbnail.url(:large)})"}
            
                .title= content.title.present? ? truncate(content.title, :length => 28) : "Untitled"
                .synopsis= truncate(content.synopsis, :length => 75)
              
                - first = false
  
        #vertical-list
          %ul#activity-list
            = render :partial => "stories/preview", :locals => { :content => @content.first }
  
  %section#my-rewards
    %h1 My Rewards
  
- if me?(@user)
  :javascript
    mpq.track('Viewed My Profile');
- else
  :javascript
    mpq.track('Viewed A Profile', {mp_note: '#{@user.name}'});

:javascript
  var user_id = '#{@user.id}';
= javascript_include_tag "users/show"
= javascript_include_tag "comments"
