- if current_user
  #reward-box
    .inner
      - if current_user == @user
        .yourself
          %h1
            You can't reward yourself, silly!
            %br
            Nice try ;)
      - else
        %h2
          Like this creator's work?
          %br
          Show them your support by rewarding!
        = form_for :reward, :url => user_rewards_path(@user), :html => {:id => "reward-form"} do |form|
          .from
            = image_tag(current_user.avatar.url(:thumbnail), :class => "avatar")
            .rewards
              .count{:original => current_user.coins}= current_user.coins
              .text credits available
          .amount
            .slider
            %p
              %span I would like to give
              = form.text_field :amount, :value => 1, :readonly => true
              %span reward credit(s) to #{@user.first_name}
          .to
            = image_tag(@user.avatar.url(:thumbnail), :class => "avatar")
            .rewards
              .count{:original => @user.lifetime_rewards}= @user.lifetime_rewards
              .text total rewards
          .comment
            = form.text_area :comment, :placeholder => "Tell others why you're rewarding this..."
            = form.hidden_field :story_id, :value => @story.present? ? @story.id : ""
            - if params[:impacted_by].present?
              = form.hidden_field :impacted_by, :value => params[:impacted_by]
          #share
            %h3 Tell your networks that you've rewarded.
            %table
              %tbody
                %tr
                  %td.text Twitter
                  %td.link
                    - if @twitter_auth
                      .switch
                        = hidden_field_tag :share_twitter, "", :name => "share[twitter]"
                        .toggle.off{:update => "#share_twitter"}
                          .handle
                    - else
                      = link_to("Configure", "/auth/twitter/configure", :class => "configure")
                %tr
                  %td.text Facebook
                  %td.link
                    - if @facebook_auth
                      .switch
                        = hidden_field_tag :share_facebook, "", :name => "share[facebook]"
                        .toggle.off{:update => "#share_facebook"}
                          .handle
                    - else
                      = link_to("Configure", "/auth/facebook/configure", :class => "configure")
          = form.submit "Give Reward"
        
        :javascript
          $('#reward-form .slider').slider({
            min: 1,
            max: #{current_user.coins},
            slide: function(event, ui) {
              $('#reward-form #reward_amount').val(ui.value);
              var $from_count = $('#reward-form .from .count');
              var new_from = parseInt($from_count.attr('original')) - ui.value;
              $from_count.text(new_from);
              var $to_count = $('#reward-form .to .count');
              var new_to = parseInt($to_count.attr('original')) + ui.value;
              $to_count.text(new_to);
            }
          });

- else
  %h3 Want to reward this?
  = link_to("Join Momeant", "#join-modal", :class => "button")
  = link_to("Login", "#login-modal", :class => "button login")